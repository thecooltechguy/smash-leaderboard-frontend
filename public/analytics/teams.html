<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Mode Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto Mono', monospace; }
        .hero-glow { box-shadow: 0 0 40px rgba(239, 68, 68, 0.3); }
    </style>
</head>
<body class="bg-black text-white antialiased min-h-screen">
    <!-- Header -->
    <header class="max-w-7xl w-full mx-auto bg-gradient-to-r from-red-600 to-red-700 border-b-4 border-yellow-500 shadow-lg relative overflow-hidden rounded-3xl mt-8 mb-6 hero-glow">
        <div class="absolute inset-0 bg-gradient-to-br from-white to-transparent opacity-10 skew-x-12 transform -translate-x-full"></div>
        <div class="relative z-10 px-6 py-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold tracking-wide uppercase text-white mb-2">Team Mode Analytics</h1>
            <p class="text-white text-opacity-90 text-sm md:text-base" id="subtitle">Loading statistics...</p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-gradient-to-r from-gray-900 to-gray-800 border-b border-gray-700 shadow-md sticky top-0 z-50 rounded-xl mx-4 mb-6">
        <div class="max-w-5xl mx-auto px-4 py-3">
            <div class="flex justify-center gap-2 md:gap-4 flex-wrap">
                <a href="/" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Home</a>
                <a href="index.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Analytics</a>
                <a href="daily.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Daily Report</a>
                <a href="betting.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Betting Odds</a>
            </div>
        </div>
    </nav>

    <!-- Format Filter Bar -->
    <div class="bg-gradient-to-r from-gray-900 to-gray-800 border border-gray-700 rounded-xl mx-4 mb-6 p-4">
        <div class="flex justify-center gap-2 md:gap-3 flex-wrap" id="format-buttons">
            <button class="format-btn px-4 py-2 bg-gray-800 border-2 border-yellow-500 rounded-lg font-semibold text-sm hover:bg-yellow-500 hover:text-black transition active" onclick="filterByFormat('all')">
                <div class="text-yellow-300 text-base">ALL</div>
                <div class="text-gray-400 text-xs" id="all-count">Loading...</div>
            </button>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 pb-12">
        <!-- Summary Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-2xl border border-gray-700 p-6 text-center">
                <div class="text-3xl md:text-4xl font-bold text-yellow-500" id="showing-matches">-</div>
                <div class="text-gray-400 text-sm mt-2">Matches Showing</div>
            </div>
            <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-2xl border border-gray-700 p-6 text-center">
                <div class="text-3xl md:text-4xl font-bold text-yellow-500" id="showing-teams">-</div>
                <div class="text-gray-400 text-sm mt-2">Unique Teams</div>
            </div>
            <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-2xl border border-gray-700 p-6 text-center">
                <div class="text-3xl md:text-4xl font-bold text-yellow-500" id="showing-partnerships">-</div>
                <div class="text-gray-400 text-sm mt-2">Partnerships</div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-2xl border border-gray-700 overflow-hidden">
            <div class="bg-gradient-to-r from-red-600 to-red-700 px-6 py-4">
                <h2 class="text-2xl font-bold text-white uppercase tracking-wider" id="table-title">All Team Data</h2>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-gray-800 border-b-2 border-yellow-500 sticky top-0">
                        <tr>
                            <th onclick="sortTable(0)" class="px-4 py-3 text-left text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">#</th>
                            <th onclick="sortTable(1)" class="px-4 py-3 text-left text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Team / Duo / Partnership</th>
                            <th onclick="sortTable(2)" class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Type</th>
                            <th onclick="sortTable(3)" class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Format</th>
                            <th onclick="sortTable(4)" class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Record</th>
                            <th onclick="sortTable(5)" class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Win Rate</th>
                            <th onclick="sortTable(6)" class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase cursor-pointer hover:text-yellow-500 transition">Games</th>
                        </tr>
                    </thead>
                    <tbody id="main-tbody" class="divide-y divide-gray-700"></tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="bg-gradient-to-r from-gray-900 to-gray-800 border-t border-gray-700 py-6 text-center text-gray-400 text-sm mt-12">
        <p>Click format buttons to filter • Click column headers to sort</p>
    </footer>

    <script>
        const teamsData = {"total_team_matches": 739,"match_formats": {"1v2": 212,"2v2": 271,"2v1": 60,"1v3": 65,"3v1": 5,"3v2": 19,"1v4": 27,"2v4": 4,"3v3": 52,"2v3": 15,"1v6": 2,"1v5": 7},"true_2v2_count": 271,"best_duos": [{"duo": "mmmmm & own","player1": "mmmmm","player2": "own","wins": 4,"losses": 0,"total": 4,"win_rate": 100.0},{"duo": "jmoon & shafaq","player1": "jmoon","player2": "shafaq","wins": 3,"losses": 0,"total": 3,"win_rate": 100.0},{"duo": "audrey & keneru","player1": "audrey","player2": "keneru","wins": 3,"losses": 0,"total": 3,"win_rate": 100.0},{"duo": "shafaq & sky","player1": "shafaq","player2": "sky","wins": 2,"losses": 0,"total": 2,"win_rate": 100.0},{"duo": "fateen & keneru","player1": "fateen","player2": "keneru","wins": 2,"losses": 0,"total": 2,"win_rate": 100.0},{"duo": "caleb & jmoon","player1": "caleb","player2": "jmoon","wins": 2,"losses": 0,"total": 2,"win_rate": 100.0},{"duo": "nish & subby","player1": "nish","player2": "subby","wins": 10,"losses": 3,"total": 13,"win_rate": 76.9},{"duo": "samin & shafaq","player1": "samin","player2": "shafaq","wins": 6,"losses": 2,"total": 8,"win_rate": 75.0},{"duo": "nish & shafaq","player1": "nish","player2": "shafaq","wins": 3,"losses": 1,"total": 4,"win_rate": 75.0},{"duo": "keneru & lag","player1": "keneru","player2": "lag","wins": 3,"losses": 1,"total": 4,"win_rate": 75.0}],"best_teams": [{"team": "samin","members": ["samin"],"size": 1,"wins": 37,"losses": 0,"total": 37,"win_rate": 100.0,"total_kos": 154,"total_falls": 61},{"team": "own","members": ["own"],"size": 1,"wins": 15,"losses": 0,"total": 15,"win_rate": 100.0,"total_kos": 45,"total_falls": 27},{"team": "pat","members": ["pat"],"size": 1,"wins": 10,"losses": 0,"total": 10,"win_rate": 100.0,"total_kos": 38,"total_falls": 17}],"most_active_teams": [{"team": "fateen & subby","members": ["fateen","subby"],"size": 2,"wins": 38,"losses": 26,"total": 64,"win_rate": 59.4,"total_kos": 253,"total_falls": 286},{"team": "habeas","members": ["habeas"],"size": 1,"wins": 39,"losses": 13,"total": 52,"win_rate": 75.0,"total_kos": 167,"total_falls": 100}],"best_partnerships": [{"partnership": "jeni & shafaq","player1": "jeni","player2": "shafaq","games_together": 4,"wins_together": 4,"win_rate": 100.0},{"partnership": "audrey & shafaq","player1": "audrey","player2": "shafaq","games_together": 4,"wins_together": 4,"win_rate": 100.0}],"most_frequent_partnerships": [{"partnership": "fateen & subby","player1": "fateen","player2": "subby","games_together": 107,"wins_together": 53,"win_rate": 49.5}]};

        let allRows = [];
        let currentFilter = 'all';

        function init() {
            document.getElementById('subtitle').textContent = `${teamsData.total_team_matches} team matches • ${teamsData.true_2v2_count} true 2v2s`;
            renderFormatButtons();
            buildAllRows();
            renderTable('all');
        }

        function renderFormatButtons() {
            const container = document.getElementById('format-buttons');
            const formats = teamsData.match_formats;
            const sorted = Object.entries(formats).sort((a, b) => b[1] - a[1]);

            container.innerHTML = `
                <button class="format-btn px-4 py-2 bg-gray-800 border-2 border-yellow-500 rounded-lg font-semibold text-sm hover:bg-yellow-500 hover:text-black transition active" onclick="filterByFormat('all')">
                    <div class="text-yellow-300 text-base">ALL</div>
                    <div class="text-gray-400 text-xs">${teamsData.total_team_matches} matches</div>
                </button>
            ` + sorted.map(([fmt, count]) => `
                <button class="format-btn px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg font-semibold text-sm hover:bg-gray-700 transition" onclick="filterByFormat('${fmt}')">
                    <div class="text-white text-base">${fmt}</div>
                    <div class="text-gray-400 text-xs">${count} matches</div>
                </button>
            `).join('');
        }

        function buildAllRows() {
            allRows = [];

            // Add teams
            [...(teamsData.best_teams || []), ...(teamsData.most_active_teams || [])].forEach(t => {
                if (!allRows.find(r => r.name === t.team && r.type === 'Team')) {
                    const format = t.size === 1 ? '1vX' : t.size === 2 ? '2v2' : `${t.size}vX`;
                    allRows.push({
                        name: t.team,
                        type: 'Team',
                        format,
                        size: t.size,
                        wins: t.wins,
                        losses: t.losses,
                        total: t.total,
                        winRate: t.win_rate
                    });
                }
            });

            // Add duos
            (teamsData.best_duos || []).forEach(d => {
                allRows.push({
                    name: d.duo,
                    type: 'Duo (2v2)',
                    format: '2v2',
                    size: 2,
                    wins: d.wins,
                    losses: d.losses,
                    total: d.total,
                    winRate: d.win_rate
                });
            });

            // Add partnerships
            [...(teamsData.best_partnerships || []), ...(teamsData.most_frequent_partnerships || [])].forEach(p => {
                if (!allRows.find(r => r.name === p.partnership)) {
                    allRows.push({
                        name: p.partnership,
                        type: 'Partnership',
                        format: 'Any',
                        size: 2,
                        wins: p.wins_together,
                        losses: p.games_together - p.wins_together,
                        total: p.games_together,
                        winRate: p.win_rate
                    });
                }
            });

            allRows.sort((a, b) => b.total - a.total);
        }

        function filterByFormat(format) {
            currentFilter = format;
            document.querySelectorAll('.format-btn').forEach(btn => {
                btn.classList.remove('active', 'border-yellow-500', 'border-2');
                btn.classList.add('border', 'border-gray-600');
            });
            event.target.closest('.format-btn').classList.add('active', 'border-yellow-500', 'border-2');
            event.target.closest('.format-btn').classList.remove('border-gray-600');
            renderTable(format);
        }

        function renderTable(filter) {
            const tbody = document.getElementById('main-tbody');
            let filtered = allRows;

            if (filter !== 'all') {
                filtered = allRows.filter(r => {
                    if (filter === '2v2') return r.format === '2v2';
                    if (filter === '3v3') return r.size === 3 && r.type === 'Team';
                    if (r.type === 'Partnership') return false;
                    const parts = filter.split('v');
                    if (parts.length === 2) {
                        const sizes = parts.map(Number);
                        return sizes.includes(r.size);
                    }
                    return true;
                });
            }

            document.getElementById('showing-matches').textContent = filtered.length;
            document.getElementById('showing-teams').textContent = filtered.filter(r => r.type === 'Team').length;
            document.getElementById('showing-partnerships').textContent = filtered.filter(r => r.type === 'Partnership').length;
            document.getElementById('table-title').textContent = filter === 'all' ? 'ALL TEAM DATA' : `${filter.toUpperCase()} MATCHES`;

            tbody.innerHTML = filtered.map((row, i) => {
                const wrColor = row.winRate >= 60 ? 'text-green-400' : row.winRate < 40 ? 'text-red-400' : 'text-yellow-500';
                const badgeColor = row.format === '2v2' ? 'bg-green-600' : row.format === '3v3' ? 'bg-purple-600' : 'bg-blue-600';

                return `
                    <tr class="hover:bg-gray-800 transition">
                        <td class="px-4 py-3 text-gray-400">${i + 1}</td>
                        <td class="px-4 py-3 font-semibold text-white">${row.name}</td>
                        <td class="px-4 py-3 text-center text-gray-300 text-xs">${row.type}</td>
                        <td class="px-4 py-3 text-center">
                            <span class="inline-block px-2 py-1 rounded text-xs font-bold text-white ${badgeColor}">${row.format}</span>
                        </td>
                        <td class="px-4 py-3 text-center text-gray-300">${row.wins}W - ${row.losses}L</td>
                        <td class="px-4 py-3 text-center">
                            <span class="font-bold ${wrColor}">${row.winRate.toFixed(1)}%</span>
                            <div class="w-16 h-2 bg-gray-700 rounded-full overflow-hidden mx-auto mt-1">
                                <div class="${wrColor.replace('text-', 'bg-')} h-full" style="width: ${row.winRate}%"></div>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-center text-gray-300">${row.total}</td>
                    </tr>
                `;
            }).join('');
        }

        function sortTable(colIdx) {
            const tbody = document.getElementById('main-tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            rows.sort((a, b) => {
                let aVal = a.cells[colIdx].textContent.replace('%', '').replace('W', '').replace('L', '').replace('-', '').trim();
                let bVal = b.cells[colIdx].textContent.replace('%', '').replace('W', '').replace('L', '').replace('-', '').trim();

                const aNum = parseFloat(aVal);
                const bNum = parseFloat(bVal);
                if (!isNaN(aNum) && !isNaN(bNum)) return bNum - aNum;
                return aVal.localeCompare(bVal);
            });

            rows.forEach(row => tbody.appendChild(row));
        }

        init();
    </script>
</body>
</html>
