<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Smash Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto Mono', monospace; }
        .hero-glow { box-shadow: 0 0 40px rgba(239, 68, 68, 0.3); }
    </style>
</head>
<body class="bg-black text-white antialiased min-h-screen">
    <!-- Header -->
    <header class="max-w-5xl w-full mx-auto bg-gradient-to-r from-red-600 to-red-700 border-b-4 border-yellow-500 shadow-lg relative overflow-hidden rounded-3xl mt-8 mb-6 hero-glow">
        <div class="absolute inset-0 bg-gradient-to-br from-white to-transparent opacity-10 skew-x-12 transform -translate-x-full"></div>
        <div class="relative z-10 px-6 py-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold tracking-wide uppercase text-white mb-2">Daily Smash Report</h1>
            <p class="text-white text-opacity-90 text-sm md:text-base">Your office arena sports desk</p>
            <p class="text-yellow-300 font-bold text-lg mt-3" id="report-date">Loading...</p>
            <p class="text-white text-opacity-70 text-xs mt-1" id="generated-at"></p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-gradient-to-r from-gray-900 to-gray-800 border-b border-gray-700 shadow-md sticky top-0 z-50 rounded-xl mx-4 mb-6">
        <div class="max-w-5xl mx-auto px-4 py-3">
            <div class="flex justify-center gap-2 md:gap-4 flex-wrap">
                <a href="/" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Home</a>
                <a href="index.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Analytics</a>
                <a href="betting.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Betting Odds</a>
                <a href="teams.html" class="px-4 py-2 text-sm md:text-base font-semibold text-white hover:bg-gray-700 rounded-lg transition">Teams</a>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto px-4 pb-12">
        <div id="report-container" class="text-center py-12 text-gray-400">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-yellow-500 mb-4"></div>
            <p>Loading today's report...</p>
        </div>

        <!-- Previous Reports -->
        <section class="mt-12">
            <div class="bg-gradient-to-r from-red-600 to-red-700 px-6 py-4 rounded-t-2xl border-b-2 border-yellow-500">
                <h2 class="text-2xl font-bold text-white uppercase tracking-wider">Previous Reports</h2>
            </div>
            <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-b-2xl border border-gray-700 border-t-0 p-6">
                <ul id="history-list" class="space-y-3">
                    <li class="text-center py-6 text-gray-400">Loading history...</li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="bg-gradient-to-r from-gray-900 to-gray-800 border-t border-gray-700 py-6 text-center text-gray-400 text-sm mt-12">
        <p>Daily reports generated at 8:00 AM PST â€¢ Powered by Claude AI</p>
    </footer>

    <script>
        async function loadReport() {
            const container = document.getElementById('report-container');
            const dateEl = document.getElementById('report-date');
            const generatedEl = document.getElementById('generated-at');

            try {
                const response = await fetch('daily_report.json');
                if (!response.ok) throw new Error('No report found');
                const report = await response.json();

                dateEl.textContent = report.date;
                if (report.generated_at) {
                    const genDate = new Date(report.generated_at);
                    generatedEl.textContent = `Generated: ${genDate.toLocaleString()}`;
                }

                container.innerHTML = renderReport(report);
            } catch (error) {
                console.error('Error loading report:', error);
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ðŸŽ®</div>
                        <p class="text-xl text-gray-400 mb-2">No report available yet</p>
                        <p class="text-sm text-gray-500">Check back after 8:00 AM PST!</p>
                    </div>
                `;
                dateEl.textContent = 'No Report';
            }
        }

        function renderReport(report) {
            let html = '';

            // Breaking Headline
            html += `
                <div class="bg-gradient-to-r from-red-600 to-red-700 border-b-4 border-yellow-500 rounded-2xl p-6 mb-8 shadow-lg hero-glow">
                    <div class="text-sm font-bold text-yellow-300 uppercase tracking-widest mb-2">Breaking</div>
                    <div class="text-2xl md:text-3xl font-bold text-white">${escapeHtml(report.headline)}</div>
                </div>
            `;

            // Stats Summary
            if (report.stats_summary) {
                const stats = report.stats_summary;
                html += `
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-xl border border-gray-700 p-4 text-center">
                            <div class="text-3xl font-bold text-yellow-500">${stats.total_matches || 0}</div>
                            <div class="text-xs text-gray-400 mt-1">Matches</div>
                        </div>
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-xl border border-gray-700 p-4 text-center">
                            <div class="text-3xl font-bold text-yellow-500">${stats.total_kos || 0}</div>
                            <div class="text-xs text-gray-400 mt-1">Total KOs</div>
                        </div>
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-xl border border-gray-700 p-4 text-center">
                            <div class="text-3xl font-bold text-yellow-500">${stats.player_stats?.length || 0}</div>
                            <div class="text-xs text-gray-400 mt-1">Players</div>
                        </div>
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-xl border border-gray-700 p-4 text-center">
                            <div class="text-3xl font-bold text-yellow-500">${stats.perfect_games?.length || 0}</div>
                            <div class="text-xs text-gray-400 mt-1">Perfect Games</div>
                        </div>
                    </div>
                `;
            }

            // Player of the Day
            if (report.player_of_the_day) {
                html += `
                    <div class="bg-gradient-to-b from-yellow-600 to-yellow-700 border-4 border-yellow-500 rounded-2xl p-8 mb-8 text-center shadow-lg">
                        <div class="text-sm font-bold text-yellow-900 uppercase tracking-widest mb-2">Player of the Day</div>
                        <div class="text-4xl font-bold text-white mb-2">${escapeHtml(report.player_of_the_day.name)}</div>
                        <div class="text-base text-yellow-100">${escapeHtml(report.player_of_the_day.reason)}</div>
                    </div>
                `;
            }

            // Main Report
            html += `
                <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-2xl border border-gray-700 p-6 mb-8">
                    <div class="prose prose-invert max-w-none">
                        ${formatReportText(report.report)}
                    </div>
                </div>
            `;

            // Highlights
            if (report.highlights && report.highlights.length > 0) {
                html += `
                    <div class="mb-8">
                        <div class="bg-gradient-to-r from-red-600 to-red-700 px-6 py-4 rounded-t-2xl border-b-2 border-yellow-500">
                            <h2 class="text-xl font-bold text-white uppercase">Today's Highlights</h2>
                        </div>
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-b-2xl border border-gray-700 border-t-0 p-6">
                            <ul class="space-y-3">
                                ${report.highlights.map(h => `
                                    <li class="flex items-start gap-3 bg-gray-800 rounded-lg border border-gray-700 p-4 hover:border-yellow-500 transition">
                                        <span class="text-yellow-500 text-xl">â–¸</span>
                                        <span class="text-gray-200 flex-1">${escapeHtml(h)}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }

            // Player Stats Table
            if (report.stats_summary?.player_stats && report.stats_summary.player_stats.length > 0) {
                html += `
                    <div class="mb-8">
                        <div class="bg-gradient-to-r from-red-600 to-red-700 px-6 py-4 rounded-t-2xl border-b-2 border-yellow-500">
                            <h2 class="text-xl font-bold text-white uppercase">Player Stats</h2>
                        </div>
                        <div class="bg-gradient-to-b from-gray-900 to-gray-800 rounded-b-2xl border border-gray-700 border-t-0 overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead class="bg-gray-800 border-b border-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-bold text-gray-300 uppercase">Player</th>
                                            <th class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase">Games</th>
                                            <th class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase">W-L</th>
                                            <th class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase">Win%</th>
                                            <th class="px-4 py-3 text-center text-xs font-bold text-gray-300 uppercase">K/D</th>
                                            <th class="px-4 py-3 text-left text-xs font-bold text-gray-300 uppercase">Main</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${report.stats_summary.player_stats.map(p => `
                                            <tr class="border-b border-gray-700 hover:bg-gray-800 transition">
                                                <td class="px-4 py-3 font-semibold text-white">${escapeHtml(p.name)}</td>
                                                <td class="px-4 py-3 text-center text-gray-300">${p.games}</td>
                                                <td class="px-4 py-3 text-center text-gray-300">${p.wins}-${p.losses}</td>
                                                <td class="px-4 py-3 text-center font-bold ${getWinRateClass(p.win_rate)}">${p.win_rate}%</td>
                                                <td class="px-4 py-3 text-center text-gray-300">${p.kd_ratio}</td>
                                                <td class="px-4 py-3 text-gray-300">${escapeHtml(p.main_character)}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }

            return html;
        }

        function getWinRateClass(rate) {
            if (rate >= 60) return 'text-green-400';
            if (rate >= 40) return 'text-yellow-500';
            return 'text-red-400';
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatReportText(text) {
            if (!text) return '';
            return escapeHtml(text)
                .split('\n\n')
                .map(p => `<p class="mb-4 text-gray-300 leading-relaxed">${p}</p>`)
                .join('');
        }

        async function loadHistory() {
            const historyList = document.getElementById('history-list');

            try {
                const response = await fetch('daily_reports_history.json');
                if (!response.ok) throw new Error('No history found');
                const history = await response.json();

                if (!history.reports || history.reports.length === 0) {
                    historyList.innerHTML = '<li class="text-center py-6 text-gray-400">No previous reports yet</li>';
                    return;
                }

                historyList.innerHTML = history.reports.slice(1, 8).map(r => `
                    <li class="bg-gray-800 rounded-xl border border-gray-700 p-4 hover:border-yellow-500 transition cursor-pointer" onclick="showHistoricalReport('${r.date}')">
                        <div class="flex justify-between items-center gap-4">
                            <div class="flex-1">
                                <div class="text-sm text-yellow-500 font-semibold mb-1">${r.date}</div>
                                <div class="text-gray-200 text-sm">${escapeHtml(r.headline)}</div>
                            </div>
                            <div class="text-xs text-gray-400">${r.stats_summary?.total_matches || 0} matches</div>
                        </div>
                    </li>
                `).join('');
            } catch (error) {
                console.error('Error loading history:', error);
                historyList.innerHTML = '<li class="text-center py-6 text-gray-400">No archives available</li>';
            }
        }

        function showHistoricalReport(date) {
            alert(`Historical report for ${date} - Full archives coming soon!`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadReport();
            loadHistory();
        });
    </script>
</body>
</html>
